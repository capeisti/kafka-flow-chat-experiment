<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/vaadin-grid/vaadin-grid.html">
<link rel="import" href="/bower_components/vaadin-grid/vaadin-grid-sorter.html">


<dom-module id="le-tag">
    <template>
        <div>well then it somewhat works! {{prop}}</div>
        <button on-click="click">
            Event to server
        </button>
        <input on-change="onChange"/>

        <button on-click="keijjo">awesome</button>

        <!-- items="[[products]]" -->
        <vaadin-grid slot="grid" id="grid" class="products-grid">
            <vaadin-grid-column>
                <template class="header">
                    <vaadin-grid-sorter path="name">Name</vaadin-grid-sorter>
                </template>

                <template>[[item.name]]</template>
            </vaadin-grid-column>
            <vaadin-grid-column>
                <template class="header">
                    <vaadin-grid-sorter path="id">Id</vaadin-grid-sorter>
                </template>
                <template>[[item.id]]</template>
            </vaadin-grid-column>
        </vaadin-grid>

    </template>
</dom-module>

<script>
    class LeTag extends Polymer.Element {

        static get is() {
            return 'le-tag'
        }

        ready() {
            super.ready();
            this.providermap = new Object();

            var grid = this.$.grid;
            grid.size = 2000000000;
            var server = this.$server;
            var map = this.providermap;
            grid.dataProvider = function(params, callback) {
                map[params.page] = callback;
                server.getLines(params.page, params.pageSize);
            };
        }

        static get properties() {
            return {
                "prop": {type: String, notify: true},
                "serverprop": {type: String, notify: true}
            };
        }

        setLines(page, model) {
            this.providermap[page](JSON.parse(model));
            delete this.providermap[page];
        }

        keijjo() {
            this.$server.keijjo("");
        }

        click(e) {
            //this.dispatchEvent(new CustomEvent("customclick", {}));
            this.$server.keijjo("jeje");
        }

        customfunction(u, w) {
            window.alert("clientrpc: "+u+w);
        }

        onChange(e) {
            this.serverprop = e.target.value;
        }
    }
    customElements.define(LeTag.is, LeTag);

</script>